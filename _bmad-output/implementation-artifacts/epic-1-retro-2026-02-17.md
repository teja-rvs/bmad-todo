# Epic 1 Retrospective — Foundation and view task list

**Date:** 2026-02-17  
**Epic:** 1 — Foundation and view task list  
**Project:** bmad-todo  
**Facilitator:** Bob (Scrum Master)

---

## 1. Epic summary and metrics

| Metric | Value |
|--------|--------|
| Total stories | 3 |
| Completed | 3 |
| Completion | 100% |
| Blockers | 0 |
| Technical debt items (called out) | 0 |

**Stories delivered:**
- 1.1 — Scaffold backend and frontend applications
- 1.2 — Backend: tasks table and GET /tasks
- 1.3 — Frontend: home screen with task list or empty state

**Business outcomes:** Foundation in place: runnable Rails API + Vite/React client, tasks table and GET /tasks, CORS, and home screen with list/empty state and Warm Minimal UX. Ready for Epic 2 (create tasks).

---

## 2. Deep story analysis — patterns

### 2.1 Dev notes and struggles

- **1.1:** Environment nuance — after `gem install rails`, terminal restart (or `rbenv rehash`) needed so `rails new` is on PATH. Tailwind v4 used (`@tailwindcss/vite`); content paths are auto-detected by Vite plugin (no separate `tailwind.config.js`); directives in `src/index.css`: `@import "tailwindcss"`.
- **1.2:** Code review tightened implementation: DB-level `NOT NULL` on `title` (migration), CORS origin from `ENV.fetch("CORS_ORIGIN", "http://localhost:5173")`, explicit JSON serialization and `Task.order(created_at: :asc)` in controller, title length validation. All caught in review, not initial implementation.
- **1.3:** Code review added: 10s fetch timeout and user-facing "Request timed out" error; E2E tests mock GET /tasks for deterministic runs; `playwright.config.ts` `webServer.env` set with `VITE_API_URL` for E2E; unit test for `useEffect` cleanup on unmount.

### 2.2 Review feedback patterns

- **API and data integrity:** Explicit serialization, ordering, and DB constraints (e.g. title NOT NULL) were review themes in 1.2.
- **Frontend robustness:** Timeout and user-facing error for fetch (1.3); E2E determinism via API mocks and env configuration.
- **Scope discipline:** Stories stayed within scope (e.g. backend-only 1.2, frontend-only 1.3); no creep.

### 2.3 Lessons learned

1. **Framework-native commands and generators** — Using `rails g model`, `rails g controller`, and Vite scaffold avoided drift and rework.
2. **DB-level constraints** — Adding NOT NULL and validations at the DB layer (1.2) improves consistency and catches errors early.
3. **CORS from environment** — Configuring CORS from env (e.g. `CORS_ORIGIN`) supports different environments without code changes.
4. **E2E determinism** — Mocking GET /tasks in E2E (and setting `VITE_API_URL` in Playwright webServer) made tests stable and portable.
5. **Fetch timeout and errors** — Explicit timeout and user-facing error message improve reliability and UX when the API is slow or unavailable.
6. **Unit test coverage** — Adding 100% unit tests for all code added (including components like AddRow and branches in `getBaseUrl`) and enabling coverage reporting (`@vitest/coverage-v8`, `npm run test:run -- --coverage`) gives a clear quality gate and should be enforced for every story going forward.

### 2.4 Technical debt and testing

- **Technical debt:** No blocking debt recorded. Story files retain `{{agent_model_name_version}}` placeholders; optional to replace later.
- **Testing:** Backend minitest (model + integration for GET /tasks and CORS). Frontend Vitest (API layer, App loading/empty/list) and Playwright E2E with mocked API and env. Pattern of “mock API in E2E for core flows” is established. **Coverage:** Frontend uses v8 coverage; target 100% line coverage for new code; run `npm run test:run -- --coverage` before marking frontend stories done.

---

## 3. Previous retrospective

This is the **first** retrospective for the project. No previous action items to follow up.

---

## 4. Next epic preview — Epic 2: Create tasks

**Epic 2 objective:** User can add a task (enter text and confirm) and see the new task appear in the list, persisted on the server.  
**FRs covered:** FR8, FR9, FR10, FR11, FR12.

**Dependencies on Epic 1:**
- GET /tasks and CORS (1.2) — in place.
- Home screen with AddRow placeholder and list/empty state (1.3) — in place.
- API contract (snake_case, `{ tasks: [...] }`) and frontend `src/api/tasks.ts`, `src/types/task.ts` — in place.

**Preparation / prerequisites:**
- Backend: implement POST /tasks (Story 2.1).
- Frontend: wire AddRow to POST and show new task in list (Story 2.2).
- No new infra or tooling required; architecture and patterns from Epic 1 are sufficient.

**Risks / unknowns:** None identified. Epic 2 builds directly on Epic 1 deliverables.

---

## 5. Action items and commitments

### Process

1. **E2E patterns**  
   - **Action:** For core flows, continue using mocked API (or similar) in E2E where it improves determinism.  
   - **Owner:** Dev / QA  
   - **Success:** New E2E tests for Epic 2 follow same pattern (env + mocks where appropriate).

2. **Story completion notes**  
   - **Action:** Keep completion notes and file lists in story markdown for handoff and future retros.  
   - **Owner:** Dev  
   - **Success:** Epic 2 stories updated with completion notes and file list when done.

3. **Unit test coverage (enforced)**  
   - **Action:** For every story, add unit tests for all new or changed code. Run frontend unit tests with coverage (`npm run test:run -- --coverage`) and maintain 100% line coverage for included source files. Backend: ensure new models/controllers have corresponding unit or integration tests.  
   - **Owner:** Dev  
   - **Success:** No story marked done without tests for added code; coverage report shows 100% lines for `src` (excluding types and entry).

### Technical

- No critical technical action items. CORS, serialization, and DB constraints were addressed in 1.2; fetch timeout and error handling in 1.3. **Coverage** is now part of the definition of done (see action item above).

### Documentation

- Root README and run instructions are in place (1.1). No new doc action items for Epic 2.

### Team agreements

- Use framework generators and architecture patterns (naming, API shape, structure) for Epic 2.
- Run code review before marking stories done; apply learnings (e.g. DB constraints, env-based config, E2E determinism) where relevant.
- **Enforce unit test coverage:** All new or changed code must have unit tests; frontend must pass `npm run test:run -- --coverage` with 100% line coverage for source (excluding type-only and entry files). No story is marked done without meeting this bar.

---

## 6. Epic 2 preparation tasks

| Task | Owner | Notes |
|------|--------|--------|
| Implement POST /tasks (Story 2.1) | Dev | Backend only; follow existing API and naming patterns |
| Implement add-task flow and list update (Story 2.2) | Dev | Frontend: wire AddRow to API, refetch or merge response |
| Add/update tests for POST and add flow | Dev/QA | Backend integration tests; frontend unit + E2E as needed |
| **Run coverage before story sign-off** | Dev | Every story: `npm run test:run -- --coverage` in client; 100% line coverage for new/changed code (retro agreement) |

No separate “prep sprint” required; Epic 2 can start as soon as Story 2.1 is created and picked up.

---

## 7. Critical path

- **Before starting Epic 2:** No blockers. Epic 1 is complete; GET /tasks, CORS, and home screen are stable.
- **First priority:** Story 2.1 (POST /tasks), then Story 2.2 (add-task flow and list update).

---

## 8. Significant discoveries / epic updates

**No significant discoveries** that require changing the plan for Epic 2. Architecture and PRD assumptions held; scope and technical approach for Epic 2 remain valid.

---

## 9. Readiness assessment

| Area | Status |
|------|--------|
| Testing & quality | Backend and frontend tests in place; E2E pattern established; coverage config added; **100% line coverage enforced for new code (next steps)** |
| Deployment | Not in scope for this retro |
| Stakeholder acceptance | N/A (internal/spike) |
| Technical health | Codebase stable; patterns and conventions clear |
| Unresolved blockers | None |

Epic 1 is **complete** from a story and readiness perspective. Team can proceed to Epic 2 when ready.

---

## 10. Retrospective closure

**Key takeaways:**
1. Framework generators and architecture alignment reduced rework.
2. Code review caught important improvements (DB constraints, CORS env, serialization, fetch timeout, E2E mocks).
3. E2E determinism (mocked API + env) improved reliability and portability of tests.
4. **Unit test coverage** — 100% unit tests for code added and coverage reporting are now a team standard; enforced in next steps and Epic 2.

**Commitments:** 3 process action items (E2E patterns, completion notes, **unit test coverage enforced**); no critical path blockers. Next step: create and implement Epic 2 stories (2.1, 2.2), with coverage run and 100% line coverage for new code before marking any story done.

---

*End of Epic 1 retrospective.*
