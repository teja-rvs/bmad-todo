# Epic 3 Retrospective — Complete tasks

**Date:** 2026-02-18  
**Epic:** 3 — Complete tasks  
**Project:** bmad-todo  
**Facilitator:** Bob (Scrum Master)

---

## 1. Epic summary and metrics

| Metric | Value |
|--------|--------|
| Total stories | 2 |
| Completed | 2 |
| Completion | 100% |
| Blockers | 0 |
| Technical debt items (called out) | 0 |

**Stories delivered:**
- 3.1 — Backend: PATCH /tasks/:id to mark complete
- 3.2 — Frontend: mark task complete and show updated state

**Business outcomes:** User can mark a task complete from the list (e.g. checkbox); list updates without refresh; completion persisted on server (FR13–FR15). Ready for Epic 4 (Delete all data).

---

## 2. Deep story analysis — patterns

### 2.1 Dev notes and implementation

- **3.1:** PATCH /tasks/:id with 200 and 404; strong params for `:completed`; consistent error shape `{ "error": "Task not found" }`. Code review added CORS test for PATCH, invalid-id/empty-body/string-`completed` tests, exact "Task not found" assertion.
- **3.2:** `updateTask` in api/tasks.ts; TaskRow real checkbox and `onComplete`; merge-on-success (same as create); per-row completing state and error handling. Code review: E2E in File List, SAVE_ERROR_MESSAGE/USER_FACING_MESSAGE, completingId/isCompleting, completed color #6b8e23, updateTask invalid-body test, E2E toggle-back, .gitignore playwright-report.

### 2.2 Review feedback patterns

- **API and errors:** 404 and edge cases (invalid id, empty body, coercion) covered in tests; CORS for PATCH.
- **Frontend:** Error handling, accessibility (native checkbox, touch target, aria), per-row loading; test coverage for complete flow (unit + E2E).
- **Scope:** Backend-only 3.1, frontend-only 3.2; no scope creep.

### 2.3 Lessons learned

1. **Reuse of Epic 2 patterns** — Merge strategy, error contract, and API layer structure carried through; no rework from contract mismatch.
2. **Code review value** — Edge cases and accessibility (real checkbox, 44px target) caught in review in both stories.
3. **Backend-then-frontend split** — PATCH and 404 contract in 3.1 gave 3.2 a clear contract to implement against.
4. **Coverage clarification** — Team agreed to run coverage before sign-off and fix until 100% for changed files (enforced from Epic 4).

### 2.4 Technical debt and testing

- **Technical debt:** None blocking. Story files retain `{{agent_model_name_version}}` placeholders (cosmetic).
- **Testing:** Backend integration tests (PATCH 200/404, edge cases, CORS). Frontend unit tests (updateTask, TaskRow, App complete flow) and E2E mark-complete and toggle-back. Coverage maintained for new code.

---

## 3. Previous retrospective follow-through (Epic 2)

| Action item | Owner | Status | Evidence |
|-------------|--------|--------|----------|
| E2E practice (stop servers before E2E) | Dev/QA | ✅ Completed | E2E for mark-complete flow; same pattern |
| Story completion notes and file lists | Dev | ✅ Completed | 3.1 and 3.2 both have Completion Notes and File List |
| Unit test coverage for new code | Dev | ✅ Completed | Integration + unit + E2E for Epic 3 stories |
| API error contract alignment | Dev | ✅ Completed | 404 `{ "error": "Task not found" }`; frontend parses and shows user message |

All four Epic 2 action items completed. Team agreements (E2E practice, code review before done, coverage) were followed.

---

## 4. Next epic preview — Epic 4: Delete all data

**Epic 4 objective:** User can delete all their task data (e.g. "Delete all") with clear confirmation; list becomes empty (FR16).

**Stories:** 4.1 Backend DELETE all tasks endpoint, 4.2 Frontend delete-all control and confirmation.

**Dependencies on Epic 3:** List, create, and complete flows in place; no additional preparation. Same patterns (api/tasks.ts, error handling, refetch/clear state) apply.

**Risks / unknowns:** None. Architecture already allows optional delete_all; exact route to be decided in 4.1.

---

## 5. Action items and commitments

### Process

1. **Coverage before sign-off (100% for changed files)**  
   - **Action:** Before marking any story done, run coverage; fix until 100% line coverage for changed files.  
   - **Owner:** Dev  
   - **Success:** No story marked done without 100% coverage on touched files.

2. **Story completion notes and file lists**  
   - **Action:** Keep completion notes and file lists in story markdown when marking stories done.  
   - **Owner:** Dev  
   - **Success:** Every done story has completion notes and file list.

3. **Code review before done**  
   - **Action:** Run code review before marking a story done; address findings.  
   - **Owner:** Dev  
   - **Success:** Story status moves to done only after review.

### Technical

4. **API and CORS consistency**  
   - **Action:** For new endpoints (e.g. delete-all in 4.1), add CORS test and document route/contract in the story.  
   - **Owner:** Dev  
   - **Success:** Epic 4 backend story includes CORS and contract clarity.

### Team agreements

- Run coverage before sign-off; fix until 100% for changed files.
- Code review before marking stories done.
- E2E for user-facing flows; stop servers before E2E where it helps determinism.
- Keep completion notes and file lists in story files.

---

## 6. Epic 4 preparation tasks

| Task | Owner | Notes |
|------|--------|------|
| Implement 4.1 — Backend DELETE all tasks endpoint | Dev | Route (e.g. destroy_all), CORS, tests |
| Implement 4.2 — Frontend delete-all + confirmation | Dev | E2E for confirm and empty list |
| Run coverage before sign-off (100% for changed files) | Dev | Per retro agreement |

No separate prep sprint; Epic 4 can start when picked up.

---

## 7. Critical path

- **Before Epic 4:** No blockers. Epic 3 complete; list, create, complete flows stable.
- **Priority:** Proceed to Epic 4 stories when ready.

---

## 8. Significant discoveries / epic updates

**No significant discoveries** that require changing the plan for Epic 4. Architecture and approach remain valid. Coverage rule (100% for changed files) is a process improvement, not a scope change.

---

## 9. Readiness assessment

| Area | Status |
|------|--------|
| Testing & quality | Backend and frontend tests in place; E2E mark-complete; coverage agreement clarified |
| Deployment | Not in scope for this retro |
| Stakeholder acceptance | N/A (internal/spike) |
| Technical health | Codebase stable; patterns clear; no unresolved blockers |
| Unresolved blockers | None |

Epic 3 is **complete** from a story and readiness perspective. Team can proceed to Epic 4 when ready.

---

## 10. Retrospective closure

**Key takeaways:**

1. **Backend/frontend split and pattern reuse** — PATCH + 404 in 3.1, merge and error contract in 3.2; kept delivery predictable.
2. **Code review** — Edge cases and accessibility caught before sign-off in both stories.
3. **Epic 2 follow-through** — All four action items completed; E2E, completion notes, coverage, and error contract upheld.
4. **Coverage enforcement** — Agreed: run coverage before sign-off and fix until 100% for changed files (from Epic 4 onward).

**Commitments:** 4 action items (coverage 100% for changed files, completion notes, code review before done, API/CORS consistency); no critical path blockers. Next step: implement Epic 4 (delete all) with same patterns and coverage bar.

---

*End of Epic 3 retrospective.*
